{"ast":null,"code":"/*This file when ran opens up a page in the browser where user can remotely control Misty*/\nimport './index.css';\n\nvar requirejs = require(\"requirejs\");\n\nconst fs = require(\"fs\");\n\nconst path = require(\"path\");\n\nconst pathToFile = path.join(\"./../../\", \"config.json\");\nconst pathToNewDestination = path.join(\"/\", \"config.json\");\nfs.copyFile(pathToFile, pathToNewDestination, function (err) {\n  if (err) {\n    throw err;\n  } else {\n    console.log(\"Successfully copied and moved the file!\");\n  }\n}); // let rawdata = fs.readFile(\"./../config.json\");\n\nfs.copyFile(\"./../../config.json\", \"config.json\");\n\nconst data = require(\"config.json\");\n\nlet config = JSON.parse(data);\nvar serverIp = config[\"server_ip\"] + \":\" + config[\"server_port\"];\n/*imports the socket.io client*/\n\nconst io = require(\"socket.io-client\"),\n\n/*Creates a client that connects ot server at the specified address*/\nclient = io.connect(serverIp);\n\nvar robots = {};\nvar robots2 = {};\nvar robotSelect = document.getElementById(\"mySelection\");\nvar robotCount = 0;\n/*Get clients info and adds it to the robots dict*/\n\nclient.on(\"getInfo\", function (info) {\n  var newInfo = JSON.parse(info);\n  var sid = newInfo.SID;\n  robots[sid] = newInfo;\n  robots2[robotCount] = {\n    \"Name\": newInfo[\"Name\"],\n    \"SID\": sid\n  };\n  robotCount++;\n  var newOption = document.createElement(\"option\");\n  newOption.text = newInfo[\"Name\"];\n  robotSelect.options.add(newOption, 1);\n});\n/*Removes robot from dict on discoonect and updates robot count*/\n\nclient.on(\"robotDisconnect\", function (info) {\n  for (var i = 0; i < robotSelect.length; i++) {\n    if (robotSelect.options[i].text == robots[info].Name) robotSelect.remove(i);\n  }\n\n  delete robots[info];\n});\n/*Changes the current robot*/\n\nvar currentRobot;\nvar currentRobotSID;\n\nrobotSelect.onchange = function () {\n  currentRobot = robotSelect.options[robotSelect.selectedIndex].text;\n  console.log(currentRobot);\n  console.log(Object.keys(robots2).length);\n\n  for (var i = 0; i < Object.keys(robots2).length; i++) {\n    if (robots2[i].Name == currentRobot) {\n      currentRobotSID = robots2[i].SID;\n      client.emit(\"selectedRobot\", currentRobotSID);\n      return;\n    }\n  }\n\n  client.emit(\"selectedRobot\", null);\n};\n/*The following buttons change the color of Misty when clicked on in the browser*/\n\n\nvar greenButton = document.getElementById(\"greenButton\");\nvar blueButton = document.getElementById(\"blueButton\");\nvar redButton = document.getElementById(\"redButton\");\n/*Left arm buttons*/\n\nvar raiseLeftArm = document.getElementById(\"raiseLeftArm\");\nvar pointLeftArm = document.getElementById(\"pointLeftArm\");\nvar lowerLeftArm = document.getElementById(\"lowerLeftArm\");\n/* Controls right arm motion*/\n\nvar raiseRightArm = document.getElementById(\"raiseRightArm\");\nvar pointRightArm = document.getElementById(\"pointRightArm\");\nvar lowerRightArm = document.getElementById(\"lowerRightArm\");\n/*head motion*/\n\nvar lookUp = document.getElementById(\"lookUp\");\nvar lookLeft = document.getElementById(\"lookLeft\");\nvar lookRight = document.getElementById(\"lookRight\");\nvar lookDown = document.getElementById(\"lookDown\");\nvar currentPitch = 0;\nvar currentYaw = 0;\n/*Checks if pitch value is in between bounds*/\n\nfunction checkPitch() {\n  var bool;\n\n  if (currentPitch > 26) {\n    bool = false;\n    console.log(\"Maximum pitch reached\");\n  } else if (currentPitch < -40) {\n    bool = false;\n    console.log(\"Minimum pitch reached.\");\n  } else {\n    bool = true;\n  }\n\n  return bool;\n}\n/*Checks if yaw value is in between bounds*/\n\n\nfunction checkYaw() {\n  var bool;\n\n  if (currentYaw > 70) {\n    bool = false;\n    console.log(\"Maximum yaw reached\");\n  } else if (currentYaw < -70) {\n    bool = false;\n    console.log(\"Minimum yaw reached.\");\n  } else {\n    bool = true;\n  }\n\n  return bool;\n}\n/*Event listeners for Robot head movement*/\n\n\nvar timeout = null;\nlookUp.addEventListener(\"mousedown\", mouseDownHandler);\nlookUp.addEventListener(\"mouseup\", mouseUpHandler);\nlookUp.onclick = lookUpFunc();\nlookDown.addEventListener(\"mousedown\", mouseDownHandler1);\nlookDown.addEventListener(\"mouseup\", mouseUpHandler);\nlookDown.onclick = lookDownFunc();\nlookLeft.addEventListener(\"mousedown\", mouseDownHandler2);\nlookLeft.addEventListener(\"mouseup\", mouseUpHandler);\nlookLeft = lookLeftFunc();\nlookRight.addEventListener(\"mousedown\", mouseDownHandler3);\nlookRight.addEventListener(\"mouseup\", mouseUpHandler);\nlookRight.onclick = lookRightFunc();\n/*The following functions control head movement when buttons are held down*/\n\nfunction mouseUpHandler(event) {\n  clearInterval(timeout);\n}\n\nfunction mouseDownHandler(event) {\n  lookUpFunc();\n  timeout = setInterval(lookUpFunc, 250);\n}\n\nfunction mouseDownHandler1(event) {\n  lookDownFunc();\n  timeout = setInterval(lookDownFunc, 250);\n}\n\nfunction mouseDownHandler2(event) {\n  lookLeftFunc();\n  timeout = setInterval(lookLeftFunc, 250);\n}\n\nfunction mouseDownHandler3(event) {\n  lookRightFunc();\n  timeout = setInterval(lookRightFunc, 250);\n}\n/*The following functions send head postion updates to the robot as buttons are presses*/\n\n\nfunction lookUpFunc() {\n  currentPitch = currentPitch - 1;\n\n  if (checkPitch()) {\n    client.emit(\"moveHead\", {\n      \"Pitch\": currentPitch,\n      \"Roll\": 0,\n      \"Yaw\": currentYaw,\n      \"Velocity\": 100\n    });\n  } else {\n    currentPitch = currentPitch + 1;\n  }\n}\n\nfunction lookDownFunc() {\n  currentPitch = currentPitch + 5;\n\n  if (checkPitch()) {\n    client.emit(\"moveHead\", {\n      \"Pitch\": currentPitch,\n      \"Roll\": 0,\n      \"Yaw\": currentYaw,\n      \"Velocity\": 100\n    });\n  } else {\n    currentPitch = currentPitch - 5;\n  }\n}\n\nfunction lookRightFunc() {\n  currentYaw = currentYaw - 5;\n\n  if (checkYaw()) {\n    client.emit(\"moveHead\", {\n      \"Pitch\": currentPitch,\n      \"Roll\": 0,\n      \"Yaw\": currentYaw,\n      \"Velocity\": 100\n    });\n  } else {\n    currentYaw = currentYaw + 5;\n  }\n}\n\nfunction lookLeftFunc() {\n  currentYaw = currentYaw + 5;\n\n  if (checkYaw()) {\n    client.emit(\"moveHead\", {\n      \"Pitch\": currentPitch,\n      \"Roll\": 0,\n      \"Yaw\": currentYaw,\n      \"Velocity\": 100\n    });\n  } else {\n    currentYaw = currentYaw - 5;\n  }\n}\n/*Change color to green*/\n\n\ngreenButton.onclick = function () {\n  client.emit(\"color\", {\n    \"red\": 0,\n    \"green\": 255,\n    \"blue\": 0\n  });\n};\n/*Change color to blue*/\n\n\nblueButton.onclick = function () {\n  client.emit(\"color\", {\n    \"red\": 0,\n    \"green\": 0,\n    \"blue\": 255\n  });\n};\n/*Change color to red*/\n\n\nredButton.onclick = function () {\n  client.emit(\"color\", {\n    \"red\": 255,\n    \"green\": 0,\n    \"blue\": 0\n  });\n};\n/* Controls left arm motion*/\n\n\nraiseLeftArm.onclick = function () {\n  client.emit(\"arm\", {\n    \"Arm\": \"left\",\n    \"Position\": -90,\n    \"Velocity\": 100\n  });\n};\n\npointLeftArm.onclick = function () {\n  client.emit(\"arm\", {\n    \"Arm\": \"left\",\n    \"Position\": 0,\n    \"Velocity\": 100\n  });\n};\n\nlowerLeftArm.onclick = function () {\n  client.emit(\"arm\", {\n    \"Arm\": \"left\",\n    \"Position\": 90,\n    \"Velocity\": 100\n  });\n};\n/* Controls right arm motion*/\n\n\nraiseRightArm.onclick = function () {\n  client.emit(\"arm\", {\n    \"Arm\": \"right\",\n    \"Position\": -90,\n    \"Velocity\": 100\n  });\n};\n\npointRightArm.onclick = function () {\n  client.emit(\"arm\", {\n    \"Arm\": \"right\",\n    \"Position\": 0,\n    \"Velocity\": 100\n  });\n};\n\nlowerRightArm.onclick = function () {\n  client.emit(\"arm\", {\n    \"Arm\": \"right\",\n    \"Position\": 90,\n    \"Velocity\": 100\n  });\n};\n/*Sends a message for Misty to speak*/\n\n\nvar textButton = document.getElementById(\"textButton\");\nvar textBox = document.getElementById(\"textMessage\");\n\ntextButton.onclick = function () {\n  console.log(\"click\");\n  var text = textBox.value;\n  console.log(text);\n  client.emit(\"recievedText\", text);\n};\n/*Streams video to browser on button press*/\n\n\nvar streamVideo = document.getElementById(\"streamVideo\");\n\nstreamVideo.onclick = function () {\n  if (document.getElementById(\"streamVideo\").innerText === \"Start Video Stream\") {\n    document.getElementById(\"streamVideo\").innerText = \"Stop Video Stream\";\n    client.emit(\"requestVideo\", {\n      \"Bool\": \"True\"\n    });\n    client.on(\"getVideo\", function streamvid(data) {\n      var arrayBufferView = new Uint8Array(data);\n      var blob = new Blob([arrayBufferView], {\n        type: \"image/jpeg\"\n      });\n      var urlCreator = window.URL || window.webkitURL;\n      var imageUrl = urlCreator.createObjectURL(blob);\n      document.getElementById(\"videoSpot\").setAttribute(\"src\", imageUrl);\n    });\n  } else {\n    document.getElementById(\"streamVideo\").innerText = \"Start Video Stream\";\n    client.emit(\"requestVideo\", {\n      \"Bool\": \"False\"\n    });\n  }\n};\n/*Initiates audio stream to the python-co-client*/\n\n\nvar streamAudio = document.getElementById(\"streamAudio\");\n\nstreamAudio.onclick = function () {\n  if (document.getElementById(\"streamAudio\").innerText === \"Start Audio Stream\") {\n    document.getElementById(\"streamAudio\").innerText = \"Stop Audio Stream\";\n    client.emit(\"requestAudio\");\n  } else {\n    document.getElementById(\"streamAudio\").innerText = \"Start Audio Stream\";\n    client.emit(\"requestAudio\", {\n      \"Bool\": \"False\"\n    });\n  }\n};","map":{"version":3,"sources":["C:/Users/joshc/Desktop/mistyremotecontrol/JSclient/src/index.js"],"names":["requirejs","require","fs","path","pathToFile","join","pathToNewDestination","copyFile","err","console","log","data","config","JSON","parse","serverIp","io","client","connect","robots","robots2","robotSelect","document","getElementById","robotCount","on","info","newInfo","sid","SID","newOption","createElement","text","options","add","i","length","Name","remove","currentRobot","currentRobotSID","onchange","selectedIndex","Object","keys","emit","greenButton","blueButton","redButton","raiseLeftArm","pointLeftArm","lowerLeftArm","raiseRightArm","pointRightArm","lowerRightArm","lookUp","lookLeft","lookRight","lookDown","currentPitch","currentYaw","checkPitch","bool","checkYaw","timeout","addEventListener","mouseDownHandler","mouseUpHandler","onclick","lookUpFunc","mouseDownHandler1","lookDownFunc","mouseDownHandler2","lookLeftFunc","mouseDownHandler3","lookRightFunc","event","clearInterval","setInterval","textButton","textBox","value","streamVideo","innerText","streamvid","arrayBufferView","Uint8Array","blob","Blob","type","urlCreator","window","URL","webkitURL","imageUrl","createObjectURL","setAttribute","streamAudio"],"mappings":"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","sourcesContent":["/*This file when ran opens up a page in the browser where user can remotely control Misty*/\r\nimport './index.css'\r\nvar requirejs = require(\"requirejs\");\r\n\r\nconst fs = require(\"fs\");\r\nconst path = require(\"path\");\r\nconst pathToFile = path.join(\"./../../\", \"config.json\");\r\nconst pathToNewDestination = path.join(\"/\", \"config.json\")\r\nfs.copyFile(pathToFile, pathToNewDestination, function(err) {\r\n  if (err) {\r\n    throw err\r\n  } else {\r\n    console.log(\"Successfully copied and moved the file!\")\r\n  }\r\n})\r\n// let rawdata = fs.readFile(\"./../config.json\");\r\nfs.copyFile(\"./../../config.json\", \"config.json\");\r\nconst data = require(\"config.json\");\r\nlet config = JSON.parse(data);\r\nvar serverIp = config[\"server_ip\"] + \":\" + config[\"server_port\"];\r\n/*imports the socket.io client*/\r\nconst io = require(\"socket.io-client\"),\r\n\r\n/*Creates a client that connects ot server at the specified address*/\r\nclient = io.connect(serverIp);\r\n\r\nvar robots = {}\r\nvar robots2 = {}\r\nvar robotSelect = document.getElementById(\"mySelection\");\r\nvar robotCount = 0;\r\n\r\n/*Get clients info and adds it to the robots dict*/\r\nclient.on(\"getInfo\", function(info){\r\n  var newInfo = JSON.parse(info);\r\n  var sid = newInfo.SID;  \r\n  robots[sid] = newInfo;\r\n  robots2[robotCount] = {\"Name\": newInfo[\"Name\"], \"SID\": sid};\r\n  robotCount++;\r\n  var newOption = document.createElement(\"option\");\r\n  newOption.text = newInfo[\"Name\"];\r\n  robotSelect.options.add(newOption,1);  \r\n})\r\n\r\n/*Removes robot from dict on discoonect and updates robot count*/\r\nclient.on(\"robotDisconnect\", function(info){\r\n    for (var i=0; i<robotSelect.length; i++) {\r\n      if (robotSelect.options[i].text == robots[info].Name)\r\n          robotSelect.remove(i);\r\n  }\r\n  delete robots[info];\r\n})\r\n\r\n/*Changes the current robot*/\r\nvar currentRobot; \r\nvar currentRobotSID;\r\nrobotSelect.onchange = function(){\r\n  currentRobot = robotSelect.options[robotSelect.selectedIndex].text;\r\n  console.log(currentRobot);\r\n  console.log(Object.keys(robots2).length)\r\n  for(var i = 0; i< Object.keys(robots2).length; i++){\r\n    if(robots2[i].Name == currentRobot){\r\n      currentRobotSID = robots2[i].SID;\r\n      client.emit(\"selectedRobot\",currentRobotSID);  \r\n      return;\r\n    }     \r\n  }\r\n  client.emit(\"selectedRobot\",null);        \r\n}\r\n\r\n/*The following buttons change the color of Misty when clicked on in the browser*/\r\nvar greenButton = document.getElementById(\"greenButton\");\r\nvar blueButton = document.getElementById(\"blueButton\");\r\nvar redButton = document.getElementById(\"redButton\");\r\n\r\n/*Left arm buttons*/\r\nvar raiseLeftArm = document.getElementById(\"raiseLeftArm\");\r\nvar pointLeftArm = document.getElementById(\"pointLeftArm\");\r\nvar lowerLeftArm = document.getElementById(\"lowerLeftArm\");\r\n\r\n/* Controls right arm motion*/\r\nvar raiseRightArm = document.getElementById(\"raiseRightArm\");\r\nvar pointRightArm = document.getElementById(\"pointRightArm\");\r\nvar lowerRightArm = document.getElementById(\"lowerRightArm\");\r\n\r\n/*head motion*/\r\nvar lookUp = document.getElementById(\"lookUp\");\r\nvar lookLeft = document.getElementById(\"lookLeft\");\r\nvar lookRight = document.getElementById(\"lookRight\");\r\nvar lookDown = document.getElementById(\"lookDown\");\r\nvar currentPitch = 0;\r\nvar currentYaw = 0\r\n\r\n/*Checks if pitch value is in between bounds*/\r\nfunction checkPitch(){\r\n  var bool;\r\n  if(currentPitch > 26){\r\n    bool = false;\r\n    console.log(\"Maximum pitch reached\")\r\n    \r\n  }\r\n  else if(currentPitch < -40){\r\n    bool = false\r\n    console.log(\"Minimum pitch reached.\")\r\n  }\r\n  else{\r\n    bool = true;\r\n  }\r\n  return bool;\r\n}\r\n\r\n/*Checks if yaw value is in between bounds*/\r\nfunction checkYaw(){\r\n  var bool;\r\n  if(currentYaw > 70){\r\n    bool = false;\r\n    console.log(\"Maximum yaw reached\")\r\n    \r\n  }\r\n  else if(currentYaw < -70){\r\n    bool = false\r\n    console.log(\"Minimum yaw reached.\")\r\n  }\r\n  else{\r\n    bool = true;\r\n  }\r\n  return bool;\r\n}\r\n\r\n/*Event listeners for Robot head movement*/\r\nvar timeout = null;\r\nlookUp.addEventListener(\"mousedown\", mouseDownHandler);\r\nlookUp.addEventListener(\"mouseup\", mouseUpHandler);\r\nlookUp.onclick = lookUpFunc();\r\nlookDown.addEventListener(\"mousedown\", mouseDownHandler1);\r\nlookDown.addEventListener(\"mouseup\", mouseUpHandler);\r\nlookDown.onclick = lookDownFunc();\r\nlookLeft.addEventListener(\"mousedown\", mouseDownHandler2);\r\nlookLeft.addEventListener(\"mouseup\", mouseUpHandler);\r\nlookLeft = lookLeftFunc();\r\nlookRight.addEventListener(\"mousedown\", mouseDownHandler3);\r\nlookRight.addEventListener(\"mouseup\", mouseUpHandler);\r\nlookRight.onclick = lookRightFunc();\r\n\r\n/*The following functions control head movement when buttons are held down*/\r\nfunction mouseUpHandler(event) {\r\n  clearInterval(timeout);\r\n}\r\nfunction mouseDownHandler(event) {\r\n  lookUpFunc();\r\n  timeout = setInterval(lookUpFunc, 250);  \r\n}\r\nfunction mouseDownHandler1(event) {\r\n  lookDownFunc();\r\n  timeout = setInterval(lookDownFunc, 250);\r\n  \r\n}function mouseDownHandler2(event) {\r\n  lookLeftFunc();\r\n  timeout = setInterval(lookLeftFunc, 250);\r\n  \r\n}function mouseDownHandler3(event) {\r\n  lookRightFunc();\r\n  timeout = setInterval(lookRightFunc, 250);  \r\n}\r\n\r\n/*The following functions send head postion updates to the robot as buttons are presses*/\r\nfunction lookUpFunc() {\r\n  currentPitch = currentPitch - 1;\r\n  if(checkPitch()){\r\n    client.emit(\"moveHead\", {\"Pitch\": currentPitch, \"Roll\": 0, \"Yaw\": currentYaw, \"Velocity\": 100});\r\n  }\r\n  else{\r\n    currentPitch = currentPitch + 1;\r\n  }\r\n}\r\n\r\nfunction lookDownFunc() {\r\n  currentPitch = currentPitch + 5;\r\n  if(checkPitch()){\r\n    client.emit(\"moveHead\", {\"Pitch\": currentPitch, \"Roll\": 0, \"Yaw\": currentYaw, \"Velocity\": 100});\r\n  }\r\n  else{\r\n    currentPitch = currentPitch - 5;\r\n  }\r\n}\r\n\r\nfunction lookRightFunc() {\r\n  currentYaw = currentYaw - 5;\r\n  if(checkYaw()){\r\n    client.emit(\"moveHead\", {\"Pitch\": currentPitch, \"Roll\": 0, \"Yaw\": currentYaw, \"Velocity\": 100});\r\n  }\r\n  else{\r\n    currentYaw = currentYaw + 5;\r\n  }\r\n}\r\n\r\nfunction lookLeftFunc() {\r\n  currentYaw = currentYaw + 5;\r\n  if(checkYaw()){\r\n    client.emit(\"moveHead\", {\"Pitch\": currentPitch, \"Roll\": 0, \"Yaw\": currentYaw, \"Velocity\": 100});\r\n  }\r\n  else{\r\n    currentYaw = currentYaw - 5;\r\n  }\r\n}\r\n\r\n\r\n/*Change color to green*/\r\ngreenButton.onclick = function(){\r\n  client.emit(\"color\",{\"red\": 0,\"green\": 255,\"blue\": 0});\r\n}\r\n/*Change color to blue*/\r\nblueButton.onclick = function(){\r\n  client.emit(\"color\",{\"red\": 0,\"green\": 0,\"blue\": 255});\r\n}\r\n/*Change color to red*/\r\nredButton.onclick = function(){\r\n  client.emit(\"color\",{\"red\": 255,\"green\": 0,\"blue\": 0});\r\n}\r\n\r\n\r\n/* Controls left arm motion*/\r\nraiseLeftArm.onclick = function(){\r\n  client.emit(\"arm\",{\"Arm\": \"left\" , \"Position\": -90, \"Velocity\": 100});\r\n}\r\npointLeftArm.onclick =function(){\r\n  client.emit(\"arm\", {\"Arm\":\"left\", \"Position\": 0, \"Velocity\": 100});\r\n}\r\nlowerLeftArm.onclick =function(){\r\n  client.emit(\"arm\", {\"Arm\":\"left\", \"Position\": 90, \"Velocity\": 100});\r\n}\r\n\r\n/* Controls right arm motion*/\r\nraiseRightArm.onclick = function(){\r\n  client.emit(\"arm\",{\"Arm\": \"right\" , \"Position\": -90, \"Velocity\": 100});\r\n}\r\npointRightArm.onclick =function(){\r\n  client.emit(\"arm\", {\"Arm\":\"right\", \"Position\": 0, \"Velocity\": 100});\r\n}\r\nlowerRightArm.onclick =function(){\r\n  client.emit(\"arm\", {\"Arm\":\"right\", \"Position\": 90, \"Velocity\": 100});\r\n}\r\n\r\n/*Sends a message for Misty to speak*/\r\nvar textButton = document.getElementById(\"textButton\");\r\nvar textBox =  document.getElementById(\"textMessage\")\r\ntextButton.onclick = function(){\r\n  console.log(\"click\");\r\n  var text = textBox.value;\r\n  console.log(text);\r\n  client.emit(\"recievedText\", text);\r\n}\r\n\r\n/*Streams video to browser on button press*/\r\nvar streamVideo = document.getElementById(\"streamVideo\");\r\nstreamVideo.onclick = function(){\r\n  if(document.getElementById(\"streamVideo\").innerText === \"Start Video Stream\"){\r\n    document.getElementById(\"streamVideo\").innerText = \"Stop Video Stream\";\r\n    client.emit(\"requestVideo\", {\"Bool\": \"True\"});  \r\n    client.on(\"getVideo\", function streamvid(data){   \r\n\r\n      var arrayBufferView = new Uint8Array( data );\r\n      var blob = new Blob( [ arrayBufferView ], { type: \"image/jpeg\" } );\r\n      var urlCreator = window.URL || window.webkitURL;\r\n      var imageUrl = urlCreator.createObjectURL( blob );\r\n      document.getElementById(\"videoSpot\").setAttribute(\"src\", imageUrl);     \r\n    })\r\n  }\r\n  else{\r\n    document.getElementById(\"streamVideo\").innerText = \"Start Video Stream\"\r\n    client.emit(\"requestVideo\", {\"Bool\": \"False\"})\r\n  }\r\n}\r\n\r\n/*Initiates audio stream to the python-co-client*/\r\nvar streamAudio = document.getElementById(\"streamAudio\");\r\n  streamAudio.onclick = function(){\r\n    if(document.getElementById(\"streamAudio\").innerText === \"Start Audio Stream\"){\r\n      document.getElementById(\"streamAudio\").innerText = \"Stop Audio Stream\";\r\n      client.emit(\"requestAudio\");    \r\n    \r\n    }else{\r\n      document.getElementById(\"streamAudio\").innerText = \"Start Audio Stream\"\r\n      client.emit(\"requestAudio\", {\"Bool\": \"False\"})\r\n    }\r\n}\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\n  \r\n\r\n"]},"metadata":{},"sourceType":"module"}